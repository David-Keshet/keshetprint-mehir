<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
<title>×“×¤×•×¡ ×§×©×ª â€” ××—×©×‘×•×Ÿ ××—×™×¨×™×</title>
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700;800;900&family=Assistant:wght@400;600;700;800&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet"/>
<style>
:root{
  --ink:    #0f172a;
  --ink2:   #334155;
  --ink3:   #64748b;
  --ink4:   #94a3b8;
  --paper:  #f8f7f4;
  --card:   #ffffff;
  --border: #e2e0db;
  --border2:#ced9e8;
  --accent: #1a56db;
  --accent2:#1e40af;
  --accentL:#dbeafe;
  --accentL2:#eff6ff;
  --gold:   #b45309;
  --goldL:  #fef3c7;
  --green:  #15803d;
  --greenL: #dcfce7;
  --red:    #dc2626;
  --redL:   #fee2e2;
  --shadow: 0 1px 3px rgba(0,0,0,.08), 0 4px 16px rgba(0,0,0,.06);
  --shadow2:0 2px 8px rgba(0,0,0,.1), 0 8px 32px rgba(0,0,0,.08);
}
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;background:var(--paper);font-family:'Heebo',sans-serif;color:var(--ink);}

/* â•â•â• HEADER â•â•â• */
#hdr{
  height:64px;
  background:var(--ink);
  display:flex;align-items:center;padding:0 20px;gap:14px;
  position:sticky;top:0;z-index:100;
  border-bottom:3px solid var(--accent);
}
.hdr-logo{
  display:flex;align-items:center;gap:10px;
}
.hdr-logo .logo-icon{
  width:36px;height:36px;background:var(--accent);border-radius:8px;
  display:flex;align-items:center;justify-content:center;
  flex-shrink:0;
}
.hdr-logo .logo-icon svg{width:20px;height:20px;}
.hdr-logo h1{
  font-family:'Heebo',sans-serif;
  font-size:20px;font-weight:900;color:#fff;letter-spacing:-.5px;line-height:1;
}
.hdr-logo .tagline{font-size:10px;color:rgba(255,255,255,.45);font-weight:500;letter-spacing:.05em;}
.hdr-right{display:flex;align-items:center;gap:8px;margin-right:auto;}
.hdr-badge{
  background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.15);
  border-radius:6px;padding:4px 10px;font-size:11px;font-weight:700;color:rgba(255,255,255,.7);
}
.reset-btn{
  background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.15);
  color:rgba(255,255,255,.65);font-size:12px;font-weight:700;font-family:'Heebo',sans-serif;
  cursor:pointer;display:flex;align-items:center;gap:5px;padding:6px 12px;border-radius:8px;
  transition:all .15s;touch-action:manipulation;
}
.reset-btn:hover{background:rgba(255,255,255,.15);color:#fff;}
.reset-btn .ico{font-family:'Material Symbols Outlined';font-size:15px;}

/* â•â•â• LAYOUT â•â•â• */
#wrap{display:flex;height:calc(100vh - 64px);}
#form{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:14px;min-width:0;}
#side{width:370px;min-width:350px;overflow-y:auto;background:var(--card);
  border-right:1px solid var(--border);display:flex;flex-direction:column;
  box-shadow:-6px 0 24px rgba(0,0,0,.06);}

@media(max-width:768px){
  html,body{height:auto;overflow:auto;}
  #wrap{flex-direction:column;height:auto;}
  #form{overflow-y:visible;padding:12px;}
  #side{width:100%;min-width:0;border-right:none;border-top:2px solid var(--border);}
}

/* â•â•â• CARD ENTRANCE ANIMATION â•â•â• */
@keyframes cardIn{
  from{opacity:0;transform:translateY(14px);}
  to{opacity:1;transform:translateY(0);}
}
@keyframes priceFlash{
  0%{transform:scale(1);}
  30%{transform:scale(1.04);}
  100%{transform:scale(1);}
}
@keyframes shimmer{
  0%{background-position:200% center;}
  100%{background-position:-200% center;}
}
@keyframes pulseGlow{
  0%,100%{box-shadow:0 4px 16px rgba(21,128,61,.28);}
  50%{box-shadow:0 4px 28px rgba(21,128,61,.55);}
}

/* â•â•â• CARD â•â•â• */
.card{
  background:var(--card);border-radius:14px;
  border:1px solid var(--border);
  box-shadow:0 2px 6px rgba(0,0,0,.06),0 6px 20px rgba(0,0,0,.05);
  padding:18px;
  transition:box-shadow .25s, transform .25s;
  animation:cardIn .38s ease both;
  position:relative;overflow:visible;
}
.card:hover{
  box-shadow:0 4px 12px rgba(0,0,0,.09),0 12px 36px rgba(0,0,0,.09);
  transform:translateY(-2px);
}
/* staggered delays */
.card:nth-child(1){animation-delay:.04s;}
.card:nth-child(2){animation-delay:.10s;}
.card:nth-child(3){animation-delay:.16s;}
.card:nth-child(4){animation-delay:.22s;}
.card:nth-child(5){animation-delay:.28s;}

.ct{
  font-size:10px;font-weight:800;letter-spacing:.1em;text-transform:uppercase;
  margin-bottom:14px;display:flex;align-items:center;gap:8px;color:var(--ink3);
}
.ct-line{height:2px;flex:1;background:linear-gradient(to left,transparent,var(--border));}
.ct-accent{height:3px;width:28px;flex-shrink:0;border-radius:2px;}

/* â•â•â• LABEL â•â•â• */
.lbl{
  display:block;font-size:10px;font-weight:800;color:var(--ink3);
  margin-bottom:5px;letter-spacing:.06em;text-transform:uppercase;
}

/* â•â•â• INPUT â•â•â• */
.inp{
  width:100%;padding:10px 12px;border-radius:8px;border:1.5px solid var(--border2);
  background:#f9fafb;font-size:15px;font-weight:700;font-family:'Heebo',sans-serif;
  text-align:right;outline:none;color:var(--ink);
  transition:all .15s;-webkit-appearance:none;appearance:none;
}
.inp:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(26,86,219,.12);background:#fff;}
select.inp{cursor:pointer;padding-left:28px;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath stroke='%231a56db' stroke-width='1.5' fill='none' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
  background-repeat:no-repeat;background-position:left 8px center;background-size:16px;}
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;}
input[type=number]{-moz-appearance:textfield;}

/* â•â•â• SPINNER â•â•â• */
.spin{position:relative;}
.spin .inp{padding-left:36px;}
.sbtns{position:absolute;left:0;top:0;bottom:0;width:32px;display:flex;flex-direction:column;}
.sb{
  flex:1;background:#f1f5f9;border:none;cursor:pointer;color:var(--accent);font-size:11px;
  display:flex;align-items:center;justify-content:center;transition:background .1s;
  user-select:none;border-right:1.5px solid var(--border2);touch-action:manipulation;
}
.sb:first-child{border-bottom:1px solid var(--border2);border-radius:0 7px 0 0;}
.sb:last-child{border-radius:0 0 7px 0;}
.sb:hover,.sb:active{background:var(--accentL);color:var(--accent2);}

/* â•â•â• TYPE BUTTONS (binding) â•â•â• */
.tbg{display:flex;gap:8px;}
.tb{
  flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:6px;padding:14px 6px;
  border:2px solid var(--border);border-radius:12px;cursor:pointer;
  background:linear-gradient(160deg,#fafcff 0%,#f4f6fb 100%);
  transition:all .2s cubic-bezier(.34,1.36,.64,1);
  touch-action:manipulation;position:relative;overflow:visible;
}
.tb::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,var(--accentL2),rgba(219,234,254,.4));
  opacity:0;transition:opacity .2s;
}
.tb:hover{border-color:#93c5fd;transform:translateY(-2px);box-shadow:0 4px 14px rgba(26,86,219,.1);}
.tb:hover::before{opacity:1;}
.tb:active{transform:translateY(0);}
.tb.on{
  border-color:var(--accent);
  background:linear-gradient(160deg,#eff6ff,#dbeafe 100%);
  box-shadow:0 0 0 3px rgba(26,86,219,.12), 0 4px 14px rgba(26,86,219,.15);
  transform:translateY(-2px);
}
.tb.on::before{opacity:0;}
.tb .ico{font-family:'Material Symbols Outlined';font-size:22px;color:var(--ink4);line-height:1;position:relative;z-index:1;transition:color .2s,transform .2s;}
.tb:hover .ico{transform:scale(1.12);}
.tb.on .ico{color:var(--accent);transform:scale(1.1);}
.tb .nm{font-size:12px;font-weight:800;color:var(--ink2);position:relative;z-index:1;font-family:'Heebo',sans-serif;transition:color .2s;}
.tb.on .nm{color:var(--accent2);}
.tb .sub{font-size:9px;color:var(--ink4);font-weight:600;position:relative;z-index:1;}
.tb .tb-badge{
  position:absolute;top:6px;left:6px;
  background:linear-gradient(135deg,#92400e,#b45309);
  color:#fff;font-size:8px;font-weight:800;
  padding:2px 6px;border-radius:4px;letter-spacing:.04em;text-transform:uppercase;
  z-index:2;box-shadow:0 1px 4px rgba(0,0,0,.2);
}

/* â•â•â• SPINE VISUAL (SVG comparison inside button) â•â•â• */
.spine-visual{
  display:flex;gap:5px;align-items:flex-end;justify-content:center;
  margin-bottom:2px;position:relative;z-index:1;
}
.spine-book{display:flex;flex-direction:column;align-items:center;gap:2px;}
.spine-book .s-label{font-size:7px;font-weight:700;color:var(--ink4);letter-spacing:.03em;}
.spine-book.active .s-label{color:var(--accent);}

/* â•â•â• PILLS â•â•â• */
.pillg{display:flex;flex-wrap:wrap;gap:7px;}
.pill{
  padding:7px 16px;border-radius:8px;border:1.5px solid var(--border2);font-size:13px;
  font-weight:700;cursor:pointer;background:#fafafa;color:var(--ink2);
  transition:all .15s;touch-action:manipulation;font-family:'Heebo',sans-serif;
}
.pill:hover,.pill:active{border-color:var(--accent);color:var(--accent);}
.pill.on{background:var(--accent);color:#fff;border-color:var(--accent);
  box-shadow:0 2px 8px rgba(26,86,219,.3);}

/* â•â•â• GRIDS â•â•â• */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.g4{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:10px;}
@media(max-width:600px){.g4{grid-template-columns:1fr 1fr;}}

/* â•â•â• ALERTS â•â•â• */
.abox{border-radius:8px;padding:9px 13px;font-size:12px;font-weight:700;
  display:flex;align-items:center;gap:8px;line-height:1.5;}
.ab-blue{background:var(--accentL);border:1px solid #bfdbfe;color:var(--accent2);}
.ab-yellow{background:var(--goldL);border:1px solid #fde68a;color:var(--gold);}
.ab-green{background:var(--greenL);border:1px solid #bbf7d0;color:var(--green);}

/* â•â•â• SIDE HEADER â•â•â• */
.side-hdr{
  padding:20px;background:var(--ink);color:#fff;flex-shrink:0;
  border-bottom:3px solid var(--accent);
}
.side-hdr .slabel{font-size:9px;font-weight:800;opacity:.5;margin-bottom:6px;
  text-transform:uppercase;letter-spacing:.1em;}
.side-hdr .stitle{font-size:17px;font-weight:900;margin-bottom:3px;font-family:'Heebo',sans-serif;}
.side-hdr .sdetail{font-size:12px;opacity:.6;font-weight:500;}

/* â•â•â• PRICE BOX â•â•â• */
.price-box{
  margin:16px;border-radius:14px;padding:26px 20px;text-align:center;
  background:linear-gradient(135deg,#0f172a 0%,#1e3a5f 50%,#1e40af 100%);
  color:#fff;
  box-shadow:0 8px 32px rgba(15,23,42,.3), 0 2px 8px rgba(26,86,219,.2);
  border:1px solid rgba(255,255,255,.08);
  position:relative;overflow:hidden;
}
.price-box::before{
  content:'';position:absolute;
  top:-60px;left:-60px;width:220px;height:220px;
  background:radial-gradient(circle,rgba(26,86,219,.35) 0%,transparent 70%);
  animation:none;
}
.price-box::after{
  content:'';position:absolute;
  bottom:-40px;right:-30px;width:160px;height:160px;
  background:radial-gradient(circle,rgba(124,58,237,.25) 0%,transparent 70%);
}
/* shimmer strip */
.price-box .shimmer-strip{
  position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.6),transparent);
  background-size:200% 100%;
  animation:shimmer 2.5s linear infinite;
}
.price-box .plabel{font-size:11px;font-weight:700;opacity:.6;margin-bottom:8px;letter-spacing:.04em;position:relative;z-index:1;}
.price-box .pbig{
  font-size:66px;font-weight:900;letter-spacing:-3px;line-height:1;
  position:relative;z-index:1;font-family:'Heebo',sans-serif;
  text-shadow:0 2px 20px rgba(26,86,219,.4);
  transition:transform .15s;
}
.price-box .pbig.flash{animation:priceFlash .3s ease;}
.price-box .psub{font-size:12px;opacity:.55;margin-top:8px;position:relative;z-index:1;}
.price-box .pbadge{
  display:inline-block;margin-top:14px;
  background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.2);
  border-radius:6px;padding:5px 16px;font-size:12px;font-weight:800;
  position:relative;z-index:1;letter-spacing:.02em;
  backdrop-filter:blur(4px);
}

/* â•â•â• UNIT ROW â•â•â• */
.unit-row{
  margin:0 16px;padding:14px 18px;
  background:linear-gradient(135deg,#eff6ff,#dbeafe);
  border-radius:12px;border:1.5px solid #bfdbfe;
  display:flex;justify-content:space-between;align-items:center;
  box-shadow:0 2px 8px rgba(26,86,219,.08);
}
.unit-row span{font-size:12px;color:var(--accent2);font-weight:700;}
.unit-row b{font-size:24px;font-weight:900;color:var(--accent2);font-family:'Heebo',sans-serif;}

/* â•â•â• BREAKDOWN â•â•â• */
.breakdown{
  margin:0 16px;
  background:linear-gradient(160deg,#fafcff,#f4f7ff);
  border-radius:12px;border:1px solid #e0e8ff;
  padding:14px 16px;
  box-shadow:inset 0 1px 3px rgba(26,86,219,.04);
}
.breakdown h4{font-size:9px;font-weight:800;color:var(--ink3);text-transform:uppercase;
  letter-spacing:.1em;margin-bottom:12px;}
.brow{display:flex;justify-content:space-between;font-size:13px;color:var(--ink3);padding:5px 0;
  border-bottom:1px solid rgba(26,86,219,.07);}
.brow:last-child{border-bottom:none;}
.brow b{font-size:13px;font-weight:800;color:var(--ink);}
.brow.tot{border-top:2px solid rgba(26,86,219,.12);border-bottom:none;margin-top:6px;padding-top:10px;}
.brow.tot span{font-size:14px;font-weight:800;color:var(--ink);}
.brow.tot b{font-size:18px;color:var(--accent2);}

/* â•â•â• TABLE â•â•â• */
table{width:100%;border-collapse:collapse;font-size:12px;}
th{padding:8px 9px;text-align:right;font-weight:800;color:var(--ink3);
  background:#f1f5f9;border-bottom:2px solid var(--border2);font-size:10px;
  text-transform:uppercase;letter-spacing:.06em;}
td{padding:7px 9px;border-bottom:1px solid #f1f5f9;color:var(--ink3);}
tr.hl td{background:var(--accentL2);font-weight:800;color:var(--accent2);}
tr.hl td:nth-child(2){color:var(--accent);}
tr:not(.hl):hover td{background:#f8fafc;}

/* â•â•â• MISC â•â•â• */
.min-note{font-size:11px;text-align:center;color:var(--gold);font-weight:700;padding:4px 16px;display:none;}
.max-warn{margin:0 16px;padding:10px 14px;background:var(--redL);border:1.5px solid #fca5a5;
  border-radius:8px;font-size:12px;font-weight:700;color:var(--red);text-align:center;display:none;}

/* â•â•â• WHATSAPP â•â•â• */
.wa-wrap{padding:16px;}
.wa-btn{
  width:100%;border:none;border-radius:12px;
  background:linear-gradient(135deg,#22c55e 0%,#16a34a 50%,#15803d 100%);
  color:#fff;font-size:15px;font-weight:800;font-family:'Heebo',sans-serif;
  padding:16px 20px;display:flex;align-items:center;justify-content:center;
  gap:10px;cursor:pointer;
  box-shadow:0 4px 16px rgba(21,128,61,.3);
  transition:all .2s cubic-bezier(.34,1.36,.64,1);
  touch-action:manipulation;letter-spacing:.01em;
  animation:pulseGlow 2.8s ease-in-out infinite;
  position:relative;overflow:hidden;
}
.wa-btn::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,.15),transparent);
  border-radius:12px;
}
.wa-btn:hover{
  transform:translateY(-3px) scale(1.01);
  box-shadow:0 8px 28px rgba(21,128,61,.45);
  animation:none;
}
.wa-btn:active{transform:translateY(0) scale(.99);animation:none;}

/* â•â•â• DISCLAIMER â•â•â• */
.disclaimer{margin:0 16px 16px;padding:12px 14px;background:#fafafa;
  border:1px solid var(--border);border-radius:10px;}
.disclaimer p{font-size:11px;color:var(--ink3);line-height:1.7;font-weight:500;}

.gap{height:12px;}
.divider{height:1px;background:var(--border);margin:4px 0;}

/* â•â•â• SPINE COMPARISON CARD â•â•â• */
.spine-compare{
  display:flex;gap:12px;padding:14px;background:#f8f7f4;
  border-radius:10px;border:1px solid var(--border);margin-top:10px;
  align-items:center;
}
.sc-item{flex:1;display:flex;flex-direction:column;align-items:center;gap:6px;cursor:pointer;}
.sc-item.active .sc-label{color:var(--accent);font-weight:800;}
.sc-label{font-size:11px;font-weight:700;color:var(--ink3);text-align:center;}
.sc-sublabel{font-size:9px;color:var(--ink4);text-align:center;line-height:1.4;}
.sc-divider{width:1px;background:var(--border);align-self:stretch;}
.sc-vs{font-size:10px;font-weight:800;color:var(--ink4);padding:0 4px;}

/* â•â•â• SQUARE SPINE BADGE â•â•â• */
.sq-badge{
  display:inline-flex;align-items:center;gap:4px;
  background:linear-gradient(135deg,#1e3a5f,#1a56db);
  color:#fff;font-size:9px;font-weight:800;padding:3px 8px;border-radius:5px;
  letter-spacing:.04em;text-transform:uppercase;
}
</style>
</head>
<body>

<!-- HEADER -->
<div id="hdr">
  <div class="hdr-logo">
    <div class="logo-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="7" height="18" rx="1"/>
        <rect x="10" y="3" width="7" height="18" rx="1"/>
        <path d="M17 7h3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1h-3"/>
      </svg>
    </div>
    <div>
      <h1>×“×¤×•×¡ ×§×©×ª</h1>
      <div class="tagline">PRINT STUDIO Â· ××—×©×‘×•×Ÿ ××—×™×¨×™×</div>
    </div>
  </div>
  <div class="hdr-right">
    <div class="hdr-badge">077-512-0070</div>
    <button class="reset-btn" onclick="××¤×¡×”×›×œ()" title="××¤×¡ ×”×›×œ">
      <span class="ico">restart_alt</span>××¤×¡
    </button>
  </div>
</div>

<div id="wrap">
<div id="form">

  <!-- ×¡×•×’ ×—×•×‘×¨×ª -->
  <div class="card">
    <div class="ct">
      <div class="ct-accent" style="background:var(--accent);"></div>
      <span>×¡×•×’ ×›×¨×™×›×”</span>
      <div class="ct-line"></div>
    </div>
    <div class="tbg">
      <!-- ×¡×™×›×•×ª ×©×“×¨×” ××¨×•×‘×¢×ª -->
      <button class="tb on" id="btn-saddle-sq" onclick="×‘×—×¨×¡×•×’('saddle-sq')" style="padding:10px 4px;">
        <div class="spine-visual">
          <svg width="40" height="48" viewBox="0 0 40 48" style="overflow:visible;">
            <rect x="3" y="4" width="24" height="40" rx="1" fill="#e2e8f0" stroke="#cbd5e1" stroke-width=".8"/>
            <rect x="4" y="6" width="22" height="36" fill="#f8fafc"/>
            <line x1="7" y1="12" x2="24" y2="12" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="7" y1="17" x2="24" y2="17" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="7" y1="22" x2="24" y2="22" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="7" y1="27" x2="24" y2="27" stroke="#e2e8f0" stroke-width=".7"/>
            <rect x="27" y="4" width="10" height="40" fill="url(#sqBtnGrad)"/>
            <rect x="27" y="4"  width="10" height="3" fill="#1e3a8a"/>
            <rect x="27" y="41" width="10" height="3" fill="#1e3a8a"/>
            <line x1="29" y1="7" x2="29" y2="41" stroke="rgba(255,255,255,.22)" stroke-width="1"/>
            <rect x="29" y="14" width="6" height="2" rx="1" fill="rgba(255,255,255,.6)"/>
            <rect x="29" y="30" width="6" height="2" rx="1" fill="rgba(255,255,255,.6)"/>
            <defs>
              <linearGradient id="sqBtnGrad" x1="0" y1="0" x2="1" y2="0">
                <stop offset="0%" stop-color="#1d4ed8"/>
                <stop offset="100%" stop-color="#3b82f6"/>
              </linearGradient>
            </defs>
          </svg>
        </div>
        <span class="nm" style="font-size:10.5px;">×¡×™×›×•×ª</span>
        <span class="sub" style="font-size:8px;color:var(--accent);font-weight:800;">×©×“×¨×” ××¨×•×‘×¢×ª</span>
      </button>

      <!-- ×“×‘×§ -->
      <button class="tb" id="btn-perfect" onclick="×‘×—×¨×¡×•×’('perfect')" style="padding:10px 4px;">
        <div class="spine-visual">
          <svg width="38" height="48" viewBox="0 0 38 48" style="overflow:visible;">
            <rect x="4" y="4" width="26" height="40" rx="1" fill="#e2e8f0" stroke="#cbd5e1" stroke-width=".8"/>
            <rect x="5" y="6" width="24" height="36" fill="#f8fafc"/>
            <line x1="8" y1="12" x2="26" y2="12" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="8" y1="17" x2="26" y2="17" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="8" y1="22" x2="26" y2="22" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="8" y1="27" x2="26" y2="27" stroke="#e2e8f0" stroke-width=".7"/>
            <rect x="28" y="4" width="6" height="40" rx="0" fill="#475569"/>
            <rect x="28" y="3" width="6" height="2" fill="#334155"/>
            <rect x="28" y="43" width="6" height="2" fill="#334155"/>
          </svg>
        </div>
        <span class="nm">×“×‘×§</span>
        <span class="sub">Perfect Bound</span>
      </button>

      <!-- ×¡×¤×™×¨×œ×” -->
      <button class="tb" id="btn-wire" onclick="×‘×—×¨×¡×•×’('wire')" style="padding:10px 4px;">
        <div class="spine-visual">
          <svg width="38" height="48" viewBox="0 0 38 48" style="overflow:visible;">
            <rect x="4" y="4" width="24" height="40" rx="1" fill="#e2e8f0" stroke="#cbd5e1" stroke-width=".8"/>
            <rect x="5" y="6" width="22" height="36" fill="#f8fafc"/>
            <line x1="8" y1="12" x2="24" y2="12" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="8" y1="17" x2="24" y2="17" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="8" y1="22" x2="24" y2="22" stroke="#e2e8f0" stroke-width=".7"/>
            <line x1="8" y1="27" x2="24" y2="27" stroke="#e2e8f0" stroke-width=".7"/>
            <path d="M28 6 Q32 9 28 12 Q24 15 28 18 Q32 21 28 24 Q24 27 28 30 Q32 33 28 36 Q24 39 28 42" fill="none" stroke="#94a3b8" stroke-width="2.5" stroke-linecap="round"/>
          </svg>
        </div>
        <span class="nm">×¡×¤×™×¨×œ×”</span>
        <span class="sub">Wire-O</span>
      </button>
    </div>

    <!-- ×”×¢×¨×ª ×¡×™×›×•×ª -->
    <div id="saddleNote" style="margin-top:12px;display:none;flex-direction:column;gap:8px;">
      <div class="abox ab-blue">ğŸ”’ ×—×•×‘×¨×ª ×¡×™×›×•×ª â€” ×ª××™×“ ×“×•-×¦×“×“×™×ª Â· ×¢××•×“×™× = ××›×¤×œ×•×ª 4</div>
    </div>
  </div>

  <!-- ×¤×¨×˜×™ ×—×•×‘×¨×ª -->
  <div class="card">
    <div class="ct">
      <div class="ct-accent" style="background:#0891b2;"></div>
      <span>×¤×¨×˜×™ ×”×—×•×‘×¨×ª</span>
      <div class="ct-line"></div>
    </div>
    <div class="g4" style="align-items:end;margin-bottom:10px;">
      <div>
        <label class="lbl">×’×•×“×œ × ×™×™×¨</label>
        <select id="paperSize" class="inp" onchange="×¢×“×›×Ÿ×’×•×“×œ()" onkeydown="×˜××‘(event,'paperSize')">
          <option value="a4">A4</option>
          <option value="a5">A5</option>
          <option value="half8">×—×¦×™ ×©××™× ×™×ª</option>
          <option value="a3" id="opt-a3">A3</option>
        </select>
      </div>
      <div>
        <label class="lbl">×›××•×ª</label>
        <div class="spin">
          <div class="sbtns">
            <button class="sb" onmousedown="startSpin('quantity',1)" ontouchstart="startSpin('quantity',1)">â–²</button>
            <button class="sb" onmousedown="startSpin('quantity',-1)" ontouchstart="startSpin('quantity',-1)">â–¼</button>
          </div>
          <input id="quantity" class="inp" type="number" min="1" value="1"
            oninput="×—×©×‘××—×™×¨()" onkeydown="×˜××‘(event,'quantity')"
            onwheel="×’×œ×’×œ(event,'quantity',1)"/>
        </div>
      </div>
      <div>
        <label class="lbl">×¢××•×“×™× <span id="pgHintLbl" style="color:var(--ink4);font-weight:600;font-size:9px;"></span></label>
        <div class="spin">
          <div class="sbtns">
            <button class="sb" id="pgUp" onmousedown="startSpin('pages',4)" ontouchstart="startSpin('pages',4)">â–²</button>
            <button class="sb" id="pgDn" onmousedown="startSpin('pages',-4)" ontouchstart="startSpin('pages',-4)">â–¼</button>
          </div>
          <input id="pages" class="inp" type="number" min="1" value="4"
            oninput="×“×—×™×™×ª×¢××•×“×™×()" onblur="×ª×§×Ÿ×¢××•×“×™×()"
            onkeydown="×˜××‘(event,'pages')"
            onwheel="×’×œ×’×œ(event,'pages',4)"/>
        </div>
        <div id="pgHint" style="font-size:10px;color:var(--ink4);margin-top:3px;font-weight:600;"></div>
      </div>
      <div>
        <label class="lbl">×¡×•×’ × ×™×™×¨</label>
        <select id="paperType" class="inp" onchange="×—×©×‘××—×™×¨()" onkeydown="×˜××‘(event,'paperType')">
          <option value="offset80">× ×™×™×¨ ×¨×’×™×œ</option>
          <option value="chrome130">×›×¨×•××• 130 ×’×¨×</option>
          <option value="premium170">×¤×¨×™××™×•× 170 ×’×¨×</option>
        </select>
      </div>
    </div>
    <div id="warnBox" class="abox ab-yellow" style="display:none;">âš ï¸ ×¢××•×“×™× ×¢×•×’×œ×• ×œ××›×¤×œ×ª 4</div>
  </div>

  <!-- ×¦×‘×¢ ×”×“×¤×¡×” -->
  <div class="card">
    <div class="ct">
      <div class="ct-accent" style="background:#0891b2;"></div>
      <span>×¦×‘×¢ ×”×“×¤×¡×”</span>
      <div class="ct-line"></div>
    </div>
    <div class="tbg">
      <button class="tb" id="btn-color" onclick="×‘×—×¨×”×“×¤×¡×”('color')">
        <span class="ico" style="color:#dc2626;">palette</span>
        <span class="nm">×¦×‘×¢</span>
      </button>
      <button class="tb on" id="btn-bw" onclick="×‘×—×¨×”×“×¤×¡×”('bw')">
        <span class="ico">contrast</span>
        <span class="nm">×©×—×•×¨-×œ×‘×Ÿ</span>
      </button>
    </div>
  </div>

  <!-- ×¦×“×“×™ ×”×“×¤×¡×” -->
  <div class="card" id="doubleSideCard">
    <div class="ct">
      <div class="ct-accent" style="background:#0891b2;"></div>
      <span>×¦×“×“×™ ×”×“×¤×¡×”</span>
      <div class="ct-line"></div>
    </div>
    <div id="doubleSideWrap">
      <div class="tbg">
        <button class="tb on" id="btn-double" onclick="×‘×—×¨×¦×“('double')">
          <span class="ico">flip</span>
          <span class="nm">×“×•-×¦×“×“×™</span>
        </button>
        <button class="tb" id="btn-single" onclick="×‘×—×¨×¦×“('single')">
          <span class="ico">article</span>
          <span class="nm">×—×“-×¦×“×“×™</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ×ª×•×¡×¤×•×ª -->
  <div class="card">
    <div class="ct">
      <div class="ct-accent" style="background:#7c3aed;"></div>
      <span>×ª×•×¡×¤×•×ª</span>
      <div class="ct-line"></div>
    </div>
    <div style="margin-bottom:14px;">
      <label class="lbl">×’×‘ / ×›×¨×™×›×”</label>
      <div id="coverOptions" class="tbg"></div>
      <p id="coverHint" style="font-size:10px;color:var(--ink4);margin-top:5px;font-weight:600;"></p>
    </div>
    <div>
      <label class="lbl">×œ××™× ×¦×™×” ×œ×›×¨×™×›×”</label>
      <div class="pillg" style="margin-top:6px;" id="lamPills">
        <button class="pill on" onclick="×‘×—×¨×œ××™× ×¦×™×”(this,'none')">×œ×œ×</button>
        <button class="pill" onclick="×‘×—×¨×œ××™× ×¦×™×”(this,'matte')">××˜</button>
        <button class="pill" onclick="×‘×—×¨×œ××™× ×¦×™×”(this,'glossy')">××‘×¨×™×§</button>
      </div>
    </div>
  </div>

  <!-- ××“×¨×’ -->
  <div class="card">
    <div class="ct">
      <div class="ct-accent" style="background:#15803d;"></div>
      <span>××“×¨×’ ××—×™×¨×™×</span>
      <div class="ct-line"></div>
      <span style="font-size:9px;color:var(--ink4);font-weight:600;text-transform:none;letter-spacing:0;">â† ××¡×•××Ÿ = ×”×›××•×ª ×©×œ×š</span>
    </div>
    <div id="tierTable" style="overflow-x:auto;"></div>
  </div>

</div>

<!-- SIDE PANEL -->
<div id="side">

  <div class="side-hdr">
    <div class="slabel">×”×¦×¢×ª ××—×™×¨</div>
    <div class="stitle" id="summaryTitle">×—×•×‘×¨×ª ×¡×™×›×•×ª A4</div>
    <div class="sdetail" id="summaryDetails">1 ×™×—×™×“×” Â· 4 ×¢×' Â· ×©×—×•×¨-×œ×‘×Ÿ</div>
  </div>

  <div class="price-box">
    <div class="shimmer-strip"></div>
    <div class="plabel">×¡×”"×› ×œ×ª×©×œ×•× ×›×•×œ×œ ××¢"× 18%</div>
    <div class="pbig" id="totalWithVat">â‚ª0</div>
    <div class="psub" id="totalNoVat">×œ×¤× ×™ ××¢"×: â‚ª0.00</div>
    <div class="pbadge" id="tierLabel">ğŸŸ¢ ×¡×˜× ×“×¨×˜×™</div>
  </div>

  <div class="max-warn" id="maxWarn">âš ï¸ ×”××—×™×¨ ×’×‘×•×” â€” ×‘×“×•×§ ×›××•×ª / ××¤×¨×˜</div>
  <div class="gap"></div>

  <div class="unit-row">
    <span>××—×™×¨ ×œ×™×—×™×“×” (×œ×¤× ×™ ××¢"×)</span>
    <b id="pricePerUnit">â‚ª0.00</b>
  </div>
  <div class="gap"></div>

  <div class="breakdown">
    <h4>×¤×™×¨×•×˜ ×”××—×™×¨</h4>
    <div class="brow"><span>×”×“×¤×¡×” ×•× ×™×™×¨</span><b id="costPrint">â‚ª0.00</b></div>
    <div class="brow"><span>×›×¨×™×›×” ×•×’×™××•×¨</span><b id="costBinding">â‚ª0.00</b></div>
    <div class="brow"><span>×©×“×¨×” ××¨×•×‘×¢×ª</span><b id="costSquare">â€”</b></div>
    <div class="brow"><span>×œ××™× ×¦×™×”</span><b id="costLam">â‚ª0.00</b></div>
    <div class="brow tot"><span>×¡×”"×› ×œ×¤× ×™ ××¢"×</span><b id="costBeforeVat">â‚ª0.00</b></div>
  </div>

  <div class="gap"></div>
  <div class="min-note" id="minNote"></div>

  <div class="wa-wrap">
    <button class="wa-btn" onclick="×©×œ×—×•×•××˜×¡××¤()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
      </svg>
      ×©×œ×— ×”×–×× ×” ×‘×•×•××˜×¡××¤
    </button>
  </div>

  <div class="disclaimer">
    <p>â„¹ï¸ ×”××—×™×¨×™× ×”× <strong style="color:var(--accent2);">×”×¢×¨×›×” ×‘×œ×‘×“</strong> ×•××™× × ××”×•×•×™× ×”×¦×¢×ª ××—×™×¨ ××—×™×™×‘×ª. ×”××—×™×¨ ×”×¡×•×¤×™ × ×§×‘×¢ ×œ××—×¨ ×‘×“×™×§×ª ×”×§×•×‘×¥ ×•××™×©×•×¨ ×”×”×–×× ×”.<br/><br/>×œ××™×©×•×¨ ××—×™×¨ â€” ×¦×¨×• ×§×©×¨ ×‘×•×•××˜×¡××¤ 077-512-0070</p>
  </div>

</div>
</div>

<!-- TOGGLE STYLE -->
<style>
.toggle-wrap{cursor:pointer;}
.toggle-track{
  width:44px;height:24px;background:#cbd5e1;border-radius:12px;
  position:relative;transition:background .2s;border:1.5px solid #94a3b8;
}
.toggle-track.on{background:var(--accent);border-color:var(--accent2);}
.toggle-thumb{
  width:18px;height:18px;background:#fff;border-radius:50%;
  position:absolute;top:1px;right:2px;
  transition:transform .2s;box-shadow:0 1px 3px rgba(0,0,0,.2);
}
.toggle-track.on .toggle-thumb{transform:translateX(-20px);}
</style>

<script>
const C={
  printRate:{color:0.07,bw:0.015},setupA4:0.015,
  paper:{
    a4:   {offset80:0.0276,chrome130:0.055,premium170:0.075},
    a5:   {offset80:0.0138,chrome130:0.0275,premium170:0.0375},
    half8:{offset80:0.0248,chrome130:0.050,premium170:0.068},
    a3:   {offset80:0.051, chrome130:0.118,premium170:0.168},
  },
  lam:{none:{mat:0,min:0},matte:{mat:0.45,min:0.3},glossy:{mat:0.45,min:0.3}},
  lamMin:20,vat:0.18,minOrder:30,maxWarnAt:5000,
  squareSpine:{base:15,perUnit:2}, // ××™× ×™××•× â‚ª15 + â‚ª2 ×œ×™×—×™×“×”
};

function setupFactor(sz){return sz==='a5'?.5:sz==='half8'?.9:sz==='a3'?2:1;}
function mkPrint(q){return q<=5?6:q<=10?5:q<=25?4.2:q<=50?4:q<=100?3.2:q<=250?2.5:q<=500?2:1.6;}
function bindCharge(type,qty,pages){
  if(type==='saddle'){const u=qty<=5?4:qty<=25?3.2:qty<=100?2.8:2.2;return Math.max(8,u*qty);}
  if(type==='perfect'){const u=qty<=5?7:qty<=25?5.5:qty<=100?4.5:3.5;return Math.max(180,u*qty);}
  const base=pages>100?7:5;const u=qty<=5?base+3:qty<=25?base+2.5:qty<=100?base+2:base+1.5;return Math.max(20,u*qty);
}
function squareSpineCost(qty){
  return Math.max(C.squareSpine.base, C.squareSpine.perUnit*qty);
}
function tierName(q){return q<=5?"ğŸ”´ ××™× ×™××œ×™":q<=10?"ğŸŸ  ×§×˜×Ÿ":q<=25?"ğŸŸ¡ ×‘×™× ×•× ×™":q<=50?"ğŸŸ¢ ×¡×˜× ×“×¨×˜×™":q<=100?"ğŸ”µ ×’×“×•×œ":q<=250?"ğŸŸ£ ××¡×—×¨×™":q<=500?"âš« ×ª×¢×©×™×™×ª×™":"ğŸ’ ×¤×œ×•×¡";}

let bookType='saddle-sq',printType='bw',sideType='double',lamType='none',coverType='chrome250';

function ××¤×¡×”×›×œ(){
  document.getElementById('quantity').value='1';
  document.getElementById('pages').value='4';
  document.getElementById('paperSize').value='a4';
  document.getElementById('paperType').value='offset80';
  document.querySelectorAll('#lamPills .pill').forEach(b=>b.classList.remove('on'));
  document.querySelector('#lamPills .pill').classList.add('on');
  lamType='none';sideType='double';
  ×‘×—×¨×¡×•×’('saddle-sq');×‘×—×¨×”×“×¤×¡×”('bw');
}

function ×¢×“×›×Ÿ×’×•×“×œ(){
  const opt=document.getElementById('opt-a3');
  if(opt){opt.disabled=bookType!=='wire';opt.style.display=bookType!=='wire'?'none':'';}
  const sel=document.getElementById('paperSize');
  if(sel.value==='a3'&&bookType!=='wire') sel.value='a4';
  ×—×©×‘××—×™×¨();
}

function ×‘×—×¨×¡×•×’(t){
  bookType=t;
  const isSaddle=t==='saddle'||t==='saddle-sq';
  ['saddle','saddle-sq','perfect','wire'].forEach(x=>{
    const btn=document.getElementById('btn-'+x);
    if(btn) btn.classList.toggle('on',x===t);
  });
  const saddleNote=document.getElementById('saddleNote');
  saddleNote.style.display=isSaddle?'flex':'none';
  if(isSaddle) saddleNote.style.flexDirection='column';
  // hide sides card entirely for saddle (always double sided)
  const sidesCard=document.getElementById('doubleSideCard');
  if(sidesCard) sidesCard.style.display=isSaddle?'none':'';
  if(isSaddle) sideType='double';
  const step=isSaddle?4:1;
  document.getElementById('pgUp').onmousedown=()=>startSpin('pages',step);
  document.getElementById('pgDn').onmousedown=()=>startSpin('pages',-step);
  document.getElementById('pgUp').ontouchstart=()=>startSpin('pages',step);
  document.getElementById('pgDn').ontouchstart=()=>startSpin('pages',-step);
  document.getElementById('pages').onwheel=e=>×’×œ×’×œ(e,'pages',step);
  document.getElementById('pgHintLbl').textContent=isSaddle?'(Ã—4)':'';
  ×¢×“×›×Ÿ×›×¨×™×›×•×ª();×¢×“×›×Ÿ×’×•×“×œ();×ª×§×Ÿ×¢××•×“×™×();
}
function ×‘×—×¨×”×“×¤×¡×”(t){printType=t;document.getElementById('btn-color').classList.toggle('on',t==='color');document.getElementById('btn-bw').classList.toggle('on',t==='bw');×—×©×‘××—×™×¨();}
function ×‘×—×¨×¦×“(t){sideType=t;document.getElementById('btn-double').classList.toggle('on',t==='double');document.getElementById('btn-single').classList.toggle('on',t==='single');×—×©×‘××—×™×¨();}
function ×‘×—×¨×œ××™× ×¦×™×”(btn,t){lamType=t;document.querySelectorAll('#lamPills .pill').forEach(b=>b.classList.remove('on'));btn.classList.add('on');×—×©×‘××—×™×¨();}
function ×‘×—×¨×›×¨×™×›×”(t){coverType=t;document.querySelectorAll('.cover-opt').forEach(b=>b.classList.toggle('on',b.dataset.val===t));×—×©×‘××—×™×¨();}

function ×¢×“×›×Ÿ×›×¨×™×›×•×ª(){
  const pages=parseInt(document.getElementById('pages').value)||4;
  const optEl=document.getElementById('coverOptions');
  const hint=document.getElementById('coverHint');
  let opts=[];
  const isSaddle=bookType==='saddle'||bookType==='saddle-sq';
  if(isSaddle){opts=[{val:'chrome250',label:'×›×¨×•××• 250 ×’×¨×',sub:'××•××œ×¥'}];hint.textContent='×’×‘ ×•×¢×˜×™×¤×” ×¢×œ ×›×¨×•××• 250 ×’×¨×';}
  else if(bookType==='perfect'){opts=[{val:'chrome350',label:'×›×¨×•××• 350 ×’×¨×',sub:'××•××œ×¥'}];hint.textContent='×¢×˜×™×¤×” ×§×©×™×—×” ×¢×œ ×›×¨×•××• 350 ×’×¨×';}
  else{opts=[{val:'transparent',label:'×©×§×£ PVC',sub:'×§×œ××¡×™'},{val:'chrome350',label:'×›×¨×•××• 350 ×’×¨×',sub:'××•×—×©×™'}];hint.textContent=pages>100?'×©×§×£ ×¢×‘×”: â‚ª6 | ×›×¨×•××•: ×¢×˜×™×¤×” ××œ××”':'×©×§×£: â‚ª4 | ×›×¨×•××•: ×¢×˜×™×¤×” ××œ××”';}
  optEl.innerHTML='';
  if(!opts.find(o=>o.val===coverType)) coverType=opts[0].val;
  opts.forEach(o=>{const b=document.createElement('button');b.className='tb cover-opt'+(o.val===coverType?' on':'');b.dataset.val=o.val;b.onclick=()=>×‘×—×¨×›×¨×™×›×”(o.val);b.innerHTML=`<span class="nm">${o.label}</span><span class="sub">${o.sub}</span>`;optEl.appendChild(b);});
}

function maxPages(){const isSaddle=bookType==='saddle'||bookType==='saddle-sq';return isSaddle?140:bookType==='perfect'?300:9999;}
function ×“×—×™×™×ª×¢××•×“×™×(){const v=parseInt(document.getElementById('pages').value)||0;if(v>=(bookType==='saddle'?4:1))×—×©×‘××—×™×¨();}
function ×ª×§×Ÿ×¢××•×“×™×(){
  const inp=document.getElementById('pages');let v=parseInt(inp.value)||4;
  const isSaddle=bookType==='saddle'||bookType==='saddle-sq';
  if(v<1)v=1;const max=maxPages();let warned=false,maxW=false;
  if(isSaddle){if(v<4)v=4;if(v>max){v=max;maxW=true;}const r=Math.ceil(v/4)*4;const c=r>max?Math.floor(max/4)*4:r;if(c!==parseInt(inp.value)&&!maxW)warned=true;v=c;}
  else{if(v>max){v=max;maxW=true;}}
  inp.value=v;
  const hint=document.getElementById('pgHint'),wb=document.getElementById('warnBox');
  if(maxW){const n=isSaddle?'×¡×™×›×•×ª':'×“×‘×§';wb.textContent=`âš ï¸ ×—×•×‘×¨×ª ${n} â€” ××§×¡×™××•× ${max} ×¢××•×“×™×`;wb.style.display='flex';hint.textContent=isSaddle?v+' ×¢×\' = '+v/2+' ×’×™×œ×™×•× ×•×ª':'';}
  else if(warned){wb.textContent='âš ï¸ ×¢××•×“×™× ×¢×•×’×œ×• ×œ××›×¤×œ×ª 4';wb.style.display='flex';hint.textContent=v+' ×¢×\' = '+v/2+' ×’×™×œ×™×•× ×•×ª';}
  else{wb.style.display='none';hint.textContent=isSaddle?v+' ×¢×\' = '+v/2+' ×’×™×œ×™×•× ×•×ª':'';}
  ×¢×“×›×Ÿ×›×¨×™×›×•×ª();×—×©×‘××—×™×¨();
}

let spinTimer=null,spinInterval=null;
function startSpin(id,d){clearSpin();×©× ×”Immediate(id,d);spinTimer=setTimeout(()=>{spinInterval=setInterval(()=>×©× ×”Immediate(id,d),80);},400);const stop=()=>clearSpin();document.addEventListener('mouseup',stop,{once:true});document.addEventListener('touchend',stop,{once:true});}
function clearSpin(){clearTimeout(spinTimer);clearInterval(spinInterval);}
function ×©× ×”Immediate(id,d){
  const inp=document.getElementById(id);let v=parseFloat(inp.value)||0;v+=d;
  if(id==='pages'){const isSaddle=bookType==='saddle'||bookType==='saddle-sq';const min=isSaddle?4:1,max=maxPages();v=Math.max(min,Math.min(max,v));if(isSaddle)v=Math.min(Math.round(v/4)*4,Math.floor(max/4)*4);inp.value=v;document.getElementById('pgHint').textContent=isSaddle?v+' ×¢×\' = '+v/2+' ×’×™×œ×™×•× ×•×ª':'';×¢×“×›×Ÿ×›×¨×™×›×•×ª();}
  else{v=Math.max(1,v);inp.value=v;}×—×©×‘××—×™×¨();
}
function ×’×œ×’×œ(e,id,step){e.preventDefault();×©× ×”Immediate(id,e.deltaY<0?step:-step);}
document.addEventListener('DOMContentLoaded',()=>{document.getElementById('quantity').addEventListener('wheel',e=>×’×œ×’×œ(e,'quantity',1),{passive:false});});

const FIELDS=['quantity','pages','paperSize','paperType'];
function ×˜××‘(e,id){if(e.key!=='Enter')return;if(id==='pages')×ª×§×Ÿ×¢××•×“×™×();e.preventDefault();const i=FIELDS.indexOf(id);if(i>=0&&i<FIELDS.length-1)document.getElementById(FIELDS[i+1]).focus();}

function calcSale(qty,pages,sz,paper,withSquare){
  const baseBT=bookType==='saddle-sq'?'saddle':bookType;
  const isSingle=sideType==='single'&&baseBT!=='saddle';
  const sheets=isSingle?pages:pages/2;
  const pD=pages*C.printRate[printType]+sheets*setupFactor(sz)*C.setupA4;
  const ppD=sheets*(C.paper[sz]?.[paper]||C.paper.a4.offset80);
  const ppSell=(pD+ppD)*qty*mkPrint(qty);
  const bindSell=bindCharge(baseBT,qty,pages);
  const sqSell=withSquare?squareSpineCost(qty):0;
  const L=C.lam[lamType];const lD=(L.mat+L.min*3)*qty;
  const lamSell=lamType!=='none'?Math.max(C.lamMin,lD*mkPrint(qty)):0;
  return{print:ppSell,finish:bindSell,sq:sqSell,lam:lamSell,total:Math.max(C.minOrder,ppSell+bindSell+sqSell+lamSell)};
}

function ×—×©×‘××—×™×¨(){
  const qty=Math.max(1,parseInt(document.getElementById('quantity').value)||1);
  const pages=Math.max(1,parseInt(document.getElementById('pages').value)||4);
  const sz=document.getElementById('paperSize').value;
  const paper=document.getElementById('paperType').value;
  const isSquare=bookType==='saddle-sq';
  const s=calcSale(qty,pages,sz,paper,isSquare);
  const sale=s.total,vat=sale*1.18,pu=sale/qty;
  const szN={a4:'A4',a5:'A5',half8:'×—×¦×™ ×©××™× ×™×ª',a3:'A3'}[sz];
  const bkN={saddle:'×¡×™×›×•×ª',  'saddle-sq':'×¡×™×›×•×ª â€” ×©×“×¨×” ××¨×•×‘×¢×ª',perfect:'×“×‘×§',wire:'×¡×¤×™×¨×œ×”'}[bookType];
  const prN={color:'×¦×‘×¢',bw:'×©×—×•×¨-×œ×‘×Ÿ'}[printType];
  const sdN=(bookType==='saddle'||bookType==='saddle-sq')?'×“×•-×¦×“×“×™':{double:'×“×•-×¦×“×“×™',single:'×—×“-×¦×“×“×™'}[sideType];
  const lN={none:'',matte:' Â· ××˜',glossy:' Â· ××‘×¨×™×§'}[lamType];
  document.getElementById('summaryTitle').textContent=`×—×•×‘×¨×ª ${bkN} ${szN}`;
  document.getElementById('summaryDetails').textContent=`${qty} ×™×—×™×“×•×ª Â· ${pages} ×¢×' Â· ${prN} Â· ${sdN}${lN}`;
  const f2=n=>'â‚ª'+n.toFixed(2);
  document.getElementById('costPrint').textContent=f2(s.print);
  document.getElementById('costBinding').textContent=f2(s.finish);
  document.getElementById('costSquare').textContent=s.sq>0?f2(s.sq):'â€”';
  document.getElementById('costLam').textContent=s.lam>0?f2(s.lam):'â‚ª0.00';
  document.getElementById('costBeforeVat').textContent=f2(sale);
  document.getElementById('pricePerUnit').textContent=f2(pu);
  document.getElementById('totalWithVat').textContent='â‚ª'+vat.toFixed(0);
  const pbig=document.getElementById('totalWithVat');
  pbig.classList.remove('flash');void pbig.offsetWidth;pbig.classList.add('flash');
  document.getElementById('totalNoVat').textContent=`×œ×¤× ×™ ××¢"×: ${f2(sale)}`;
  document.getElementById('tierLabel').textContent=tierName(qty);
  const mn=document.getElementById('minNote');
  if(sale<=C.minOrder+.01){mn.textContent='âš ï¸ ××—×™×¨ ××™× ×™××•× â‚ª'+C.minOrder+' ×”×•×¤×¢×œ';mn.style.display='block';}else mn.style.display='none';
  document.getElementById('maxWarn').style.display=vat>C.maxWarnAt?'block':'none';
  buildTier(qty,pages,sz,paper);
}

function buildTier(cur,pages,sz,paper){
  const isSquare=bookType==='saddle-sq';
  const rows=[1,5,10,25,50,100,250,500,1000];
  let h=`<table><thead><tr><th>×›××•×ª</th><th>××—×™×¨ ×œ×™×—×™×“×”</th><th>×œ×¤× ×™ ××¢"×</th><th>×›×•×œ×œ ××¢"×</th></tr></thead><tbody>`;
  rows.forEach(q=>{const s=calcSale(q,pages,sz,paper,isSquare);const wv=s.total*1.18;const pu=s.total/q;const hl=q===cur?' class="hl"':'';const ov=wv>C.maxWarnAt?' style="color:var(--red);"':'';h+=`<tr${hl}><td><strong>${q.toLocaleString()}</strong></td><td style="color:var(--accent);font-weight:800;">â‚ª${pu.toFixed(2)}</td><td style="font-weight:700;">â‚ª${s.total.toFixed(0)}</td><td${ov} style="font-weight:800;">â‚ª${wv.toFixed(0)}${wv>C.maxWarnAt?' âš ï¸':''}</td></tr>`;});
  h+='</tbody></table>';document.getElementById('tierTable').innerHTML=h;
}

function ×©×œ×—×•×•××˜×¡××¤(){
  const title=document.getElementById('summaryTitle').textContent;
  const details=document.getElementById('summaryDetails').textContent;
  const print=document.getElementById('costPrint').textContent;
  const binding=document.getElementById('costBinding').textContent;
  const sq=document.getElementById('costSquare').textContent;
  const lam=document.getElementById('costLam').textContent;
  const beforeV=document.getElementById('costBeforeVat').textContent;
  const perUnit=document.getElementById('pricePerUnit').textContent;
  const total=document.getElementById('totalWithVat').textContent;
  const date=new Date().toLocaleDateString('he-IL');
  const sqLine=sq!=='â€”'?`\nâ€¢ ×©×“×¨×” ××¨×•×‘×¢×ª: ${sq}`:'';
  const msg=`âœ‰ï¸ *×‘×§×©×ª ×”×–×× ×” â€” ×“×¤×•×¡ ×§×©×ª*\n×ª××¨×™×š: ${date}\n\nğŸ“‹ *××•×¦×¨:* ${title}\nğŸ“ *×¤×¨×˜×™×:* ${details}\n\nğŸ’° *×¤×™×¨×•×˜ ××—×™×¨:*\nâ€¢ ×”×“×¤×¡×” ×•× ×™×™×¨: ${print}\nâ€¢ ×›×¨×™×›×” ×•×’×™××•×¨: ${binding}${sqLine}\nâ€¢ ×œ××™× ×¦×™×”: ${lam}\nâ€¢ ×¡×”"×› ×œ×¤× ×™ ××¢"×: ${beforeV}\nâ€¢ ××—×™×¨ ×œ×™×—×™×“×”: ${perUnit}\n\nâœ… *×¡×”"×› ×œ×ª×©×œ×•× (×›×•×œ×œ ××¢"× 18%): ${total}*\n\n_×”××—×™×¨ ×‘×›×¤×•×£ ×œ××™×©×•×¨ ×¡×•×¤×™_`;
  window.open(`https://wa.me/972775120070?text=${encodeURIComponent(msg)}`,'_blank');
}

×‘×—×¨×¡×•×’('saddle-sq');
×‘×—×¨×”×“×¤×¡×”('bw');
×—×©×‘××—×™×¨();
</script>
</body>
</html>